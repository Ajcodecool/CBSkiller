<!-- about.html -->
<div id="about-content">

  <!-- About / Legal Info -->
  <div id="legal-section">
    <a id="open-legal-modal" href="javascript:void(0)">Legal Information</a>

    <!-- Legal Modal -->
    <div id="legal-modal" class="modal">
      <div class="modal-content">
        <h2>Legal Info</h2>
        <p>This is your legal information section. Include disclaimers, privacy policy, etc.</p>
        <button id="close-modal-button">Close</button>
      </div>
    </div>
  </div>

  <!-- User / Profile Info Modals -->
  <div id="user-modal-container">
    <!-- User Modal -->
    <div id="userModal" class="modal hidden">
      <div id="userModalContent" class="modal-content">
        <div class="flex flex-col items-center">
          <img id="modal-avatar" class="w-20 h-20 rounded-full mb-4" src="" alt="Avatar" />
          <h2 id="modal-username" class="text-xl font-semibold mb-4">Hello, User</h2>
          <a class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition" href="account_settings.html">Manage Account</a>
          <button onclick="closeUserModal()" class="mt-4 text-sm hover:underline">Close</button>
        </div>
      </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="modal hidden">
      <div id="modalContent" class="modal-content">
        <img id="modal-avatar" class="w-20 h-20 rounded-full mx-auto mb-4" src="" alt="Profile Picture" />
        <h2 id="modal-username" class="text-xl font-semibold mb-2">Hello, User</h2>
        <a class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition" href="account_settings.html">Manage Account</a>
        <button onclick="closeProfileModal()" class="mt-4 text-sm hover:underline">Close</button>
      </div>
    </div>
  </div>

</div>

<script>
  // --- Legal Modal Logic ---
  const legalModal = document.getElementById("legal-modal");
  const openModalLink = document.getElementById("open-legal-modal");
  const closeModalButton = document.getElementById("close-modal-button");
  const body = document.body;

  const showLegalModal = () => {
    legalModal.classList.add('show');
    body.style.overflow = 'hidden';
  };
  const hideLegalModal = () => {
    legalModal.classList.remove('show');
    body.style.overflow = '';
  };

  if (openModalLink) openModalLink.addEventListener('click', showLegalModal);
  if (closeModalButton) closeModalButton.addEventListener('click', hideLegalModal);
  if (legalModal) legalModal.addEventListener('click', (e) => {
    if (e.target === legalModal) hideLegalModal();
  });

  // --- User/Profile Modal Logic ---
  function openUserModal() {
    const modal = document.getElementById('userModal');
    const content = document.getElementById('userModalContent');
    modal.classList.remove('hidden');
    setTimeout(() => {
      content.classList.remove('scale-95', 'opacity-0');
      content.classList.add('scale-100', 'opacity-100');
    }, 10);
  }

  function closeUserModal() {
    const modal = document.getElementById('userModal');
    const content = document.getElementById('userModalContent');
    content.classList.remove('scale-100', 'opacity-100');
    content.classList.add('scale-95', 'opacity-0');
    setTimeout(() => {
      modal.classList.add('hidden');
    }, 300);
  }

  function openProfileModal() {
    const modal = document.getElementById('profileModal');
    const content = document.getElementById('modalContent');
    modal.classList.remove('hidden');
    setTimeout(() => {
      content.classList.remove('scale-95', 'opacity-0');
      content.classList.add('scale-100', 'opacity-100');
    }, 10);
  }

  function closeProfileModal() {
    const modal = document.getElementById('profileModal');
    const content = document.getElementById('modalContent');
    content.classList.remove('scale-100', 'opacity-100');
    content.classList.add('scale-95', 'opacity-0');
    setTimeout(() => {
      modal.classList.add('hidden');
    }, 200);
  }

  // --- Load user info from Supabase ---
  document.addEventListener('DOMContentLoaded', async () => {
    const SUPABASE_URL = "https://jxxnfsydjrflnephmfjm.supabase.co";
    const SUPABASE_KEY = "YOUR_KEY_HERE";
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    const { data: { user } } = await supabase.auth.getUser();
    if (user) {
      const username = user.user_metadata?.username || user.email;
      const avatarUrl = user.user_metadata?.avatar_url || 'default-avatar.png';
      document.querySelectorAll("#modal-avatar").forEach(img => img.src = avatarUrl);
      document.querySelectorAll("#modal-username").forEach(el => el.textContent = `Hello, ${username}`);
    }
  });
</script>
